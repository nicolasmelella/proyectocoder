__d(function(g,r,i,a,m,e,d){"use strict";function t(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function n(n){for(var o=1;o<arguments.length;o++){var s=null!=arguments[o]?arguments[o]:{};o%2?t(s,!0).forEach(function(t){i(d[1])(n,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):t(s).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(s,t))})}return n}Object.defineProperty(e,'__esModule',{value:!0}),r(d[0]);var o=r(d[2])(4113),s={fontSize:'25px',height:'25px',margin:'8px',width:'25px'},u={right:'12px',bottom:'360px'},p=function(t){var n=a(d[3]).createElement(i(d[4]),{href:r(d[5]).buildLoginLink(r(d[6]).browserHistory.location.pathname,{source:'post_comment_input'})},r(d[2])(3026));return a(d[3]).createElement("span",null,r(d[2])(544,{loginLink:n}))},l=function(t){return a(d[3]).createElement("span",null,r(d[2])(2672,{username:t.username}))},c=function(t){return a(d[3]).createElement("div",{className:"up_hg"},a(d[3]).createElement("span",null,r(d[2])(2812,{username:t.username})),a(d[3]).createElement(i(d[7]),{borderless:!0,color:"ig-secondary-button",onClick:t.onClearReply},"âœ•"))},h=(function(t){function n(n){var o;return o=t.call(this,n)||this,o.$PostCommentInput1=null,o.focusAndScroll=function(){var t=function(){var t=i(d[9])(o.$PostCommentInput2);t.focus(),r(d[10]).isMobile()&&setTimeout(function(){'function'==typeof t.scrollIntoView&&(t.scrollIntoView(!0),window.scrollBy(0,-200))},10)};o.setState({hasBeenFocused:!0},function(){setTimeout(function(){return t()})})},o.$PostCommentInput5=function(t){var n=o.props,s=n.inFeedAdInfo,u=n.onCommentChange,p=n.onCommentSubmit;if(t.preventDefault(),!o.$PostCommentInput4()){u(o.state.pendingComment),o.setState({needsFlush:!1});var l=null;null!=s&&null!=(null===s||void 0===s?void 0:s.tracking_token)&&null!=(null===s||void 0===s?void 0:s.ad_id)&&(l={adId:null===s||void 0===s?void 0:s.ad_id,adTrackingToken:null===s||void 0===s?void 0:s.tracking_token}),p(l).then(function(){o.$PostCommentInput2&&o.$PostCommentInput2.blur()})}},o.$PostCommentInput6=function(t){'Enter'!==t.key||t.shiftKey||o.$PostCommentInput5(t)},o.$PostCommentInput7=function(t){t.stopPropagation()},o.$PostCommentInput8=function(t,n){o.state.commentAttempt||i(d[11])._("f3cb0e417d8b73758be753a0ddc2afb7")||r(d[12]).logAction_DEPRECATED('commentAttempt',{source:o.props.analyticsContext,type:!0===o.props.isVideo?'video':'photo',isLoggedIn:o.props.isLoggedIn}),o.setState({commentAttempt:!0,cursorIndex:n,isEmojiTrayOpen:null!=o.$PostCommentInput3,needsFlush:!0,pendingComment:t})},o.$PostCommentInput9=function(t){o.closeEmojiTrayIfOpen()},o.$PostCommentInput10=function(t){o.$PostCommentInput2=t,i(d[11])._("d9876f2cb8a2db484645b0588a557829")&&(null!=t?o.$PostCommentInput1=i(d[13]).trackTypingPerf(t,'PostCommentInput'):null!=o.$PostCommentInput1&&(o.$PostCommentInput1(),o.$PostCommentInput1=null))},o.$PostCommentInput11=function(t){o.setState({hasBeenFocused:!0,hasFocus:!0})},o.$PostCommentInput12=function(t){var n;o.setState({hasFocus:!1}),t.relatedTarget!==o.emojiPickerButton.current&&(null==t.relatedTarget||t.relatedTarget instanceof Node&&!(null===(n=o.emojiPickerTray.current)||void 0===n?void 0:n.contains(t.relatedTarget)))&&o.closeEmojiTrayIfOpen()},o.$PostCommentInput13=function(){var t=o.props,n=t.analyticsContext,s=t.id,u=t.ownerId;r(d[14]).logInteractionAction({containerModule:n,eventName:'instagram_organic_comment_button',mediaId:s,mediaAuthorId:u})},o.$PostCommentInput14=function(t,n){var s=i(d[15])(t,n,o.state.pendingComment,o.state.cursorIndex),u=s.updatedCursorIndex,p=s.updatedText;o.$PostCommentInput8(p,u)},o.$PostCommentInput15=function(t){var n,s;o.$PostCommentInput3=t;var u=(null===(n=o.$PostCommentInput2)||void 0===n?void 0:n.selectionStart)||0,p=(null===(s=o.$PostCommentInput2)||void 0===s?void 0:s.selectionEnd)||0,l=o.state.pendingComment.substring(0,u)+t+o.state.pendingComment.substring(p),c=u+t.length;o.$PostCommentInput8(l,c)},o.$PostCommentInput16=function(t){!0===t&&(i(d[11])._("48eee4ddf4106d3a8e87f36d9a02fa5f")||r(d[12]).logAction_DEPRECATED('emojiButtonClicked',{source:o.props.analyticsContext,type:!0===o.props.isVideo?'video':'photo',isLoggedIn:o.props.isLoggedIn}),i(d[16]).incr('web.emoji.button.clicked')),o.setState({isEmojiTrayOpen:t})},o.emojiPickerButton=a(d[3]).createRef(),o.emojiPickerTray=a(d[3]).createRef(),o.state={commentAttempt:!1,hasBeenFocused:!1,needsFlush:!1,pendingComment:n.pendingComment,cursorIndex:n.pendingComment.length,isEmojiTrayOpen:!1},o}i(d[8])(n,t);var h=n.prototype;return h.componentDidMount=function(){!0===this.props.willFocusAndScrollToInput&&this.focusAndScroll()},h.componentWillUnmount=function(){!this.props.commentSaveIsInFlight&&this.state.needsFlush&&this.state.pendingComment.length>0&&this.props.onCommentChange(this.state.pendingComment)},h.componentDidUpdate=function(t,n){var o=this.props,s=o.commentSaveIsInFlight,u=o.pendingComment;this.$PostCommentInput2&&!n.hasBeenFocused&&this.state.hasBeenFocused&&this.$PostCommentInput2.focus(),t.pendingComment!==u&&(this.setState({pendingComment:u,cursorIndex:u.length}),this.$PostCommentInput2&&this.$PostCommentInput2.focus());var p=n.isEmojiTrayOpen!==this.state.isEmojiTrayOpen;(null!=this.$PostCommentInput3||p)&&(this.$PostCommentInput3=null,this.$PostCommentInput2&&(p&&this.setState({cursorIndex:this.$PostCommentInput2.selectionEnd}),this.$PostCommentInput2.focus())),t.commentSaveIsInFlight&&!s&&''===u&&this.setState({pendingComment:'',needsFlush:!0})},h.shouldComponentUpdate=function(t,n){return this.props.className!==t.className||this.props.commentSaveIsInFlight!==t.commentSaveIsInFlight||this.props.pendingComment!==t.pendingComment||this.state.pendingComment!==n.pendingComment||this.state.hasBeenFocused!==n.hasBeenFocused||this.state.hasFocus!==n.hasFocus||this.state.isEmojiTrayOpen!==n.isEmojiTrayOpen},h.$PostCommentInput4=function(){return 0===this.state.pendingComment.trim().length||this.props.commentSaveIsInFlight},h.closeEmojiTrayIfOpen=function(){this.setState(function(t){return t.isEmojiTrayOpen?{isEmojiTrayOpen:!1}:{}})},h.displayForm=function(){var t=r(d[6]).browserHistory.location.pathname===r(d[17]).FEED_PATH&&!0!==this.props.inModal&&r(d[18]).hasDenserFeed();return a(d[3]).createElement("form",{className:"X7cDz",method:"POST",onSubmit:this.$PostCommentInput5},this.props.commentSaveIsInFlight&&a(d[3]).createElement(i(d[19]),{position:"absolute"}),r(d[10]).isDesktop()&&a(d[3]).createElement("div",{className:(t?"":"rct3S")+" "+(t?"Vhn1b":"")},a(d[3]).createElement(r(d[20]).IGCoreEmojiButton,{emojiArrowLeftOffset:17,emojiIconStyles:s,emojiTrayPositionStyles:u,emojiTrayRef:this.emojiPickerTray,emojiTrayWidth:295,isEmojiTrayOpen:this.state.isEmojiTrayOpen,onEmojiClick:this.$PostCommentInput15,ref:this.emojiPickerButton,setEmojiTrayOpen:this.$PostCommentInput16,zeroPadding:!0})),a(d[3]).createElement(i(d[21]),{"aria-label":o,autosize:!0===this.props.forceTextareaAutosize||!0===this.props.willFocusAndScrollToInput||this.state.hasBeenFocused||''!==this.state.pendingComment,className:"Ypffh",cursorIndex:this.state.cursorIndex,"data-testid":"post-comment-text-area",disabled:this.props.commentSaveIsInFlight,inputRef:this.$PostCommentInput10,onBlur:this.$PostCommentInput12,onChange:this.$PostCommentInput8,onClick:this.$PostCommentInput9,onFocus:this.$PostCommentInput11,onKeyPress:this.$PostCommentInput6,onKeyUp:this.$PostCommentInput7,onTypeaheadResultSelect:this.$PostCommentInput14,placeholder:o,value:this.state.pendingComment}),this.props.hasPostButton&&a(d[3]).createElement(i(d[7]),{borderless:!0,"data-testid":"post-comment-input-button",disabled:this.$PostCommentInput4(),onClick:this.$PostCommentInput13,type:"submit"},a(d[3]).createElement(i(d[22]).BodyEmphasized,{color:"ig-primary-button",zeroMargin:!0},r(d[2])(3449))))},h.$PostCommentInput17=function(){return!this.$PostCommentInput2||this.props.viewportHeight-this.$PostCommentInput2.getBoundingClientRect().bottom>200},h.render=function(){var t=this.props,n=t.canViewerProvideFeedback,o=t.className,s=t.hasRichCommentInput,u=t.isLoggedIn,h=t.onClearReply,C=t.ownerUsername,I=t.repliedToUsername,f=t.viewerProfilePicture;return a(d[3]).createElement("section",{className:i(d[23])("sH9wk "+(!0===s?"n1LTb":""),o)},a(d[3]).createElement("div",{className:"RxpZH"},!0===s&&null!=f&&''!==f&&a(d[3]).createElement(i(d[24]),{className:"_8tZ3C",isLink:!1,profilePictureUrl:f,size:i(d[25]).AVATAR_SIZES.small}),u?n?this.displayForm():a(d[3]).createElement(l,{username:i(d[9])(C)}):a(d[3]).createElement(p,null)),null!=I&&''!==I&&r(d[10]).isMobile()&&a(d[3]).createElement(c,{onClearReply:h,username:I}),u&&n&&!0===this.state.hasFocus&&a(d[3]).createElement(i(d[26]),{className:(r(d[10]).isMobile()?"q6Mjn":"")+" "+(r(d[10]).isMobile()?"":"Mfkwx")+" "+(r(d[10]).isMobile()||this.$PostCommentInput17()?"":"wUsz1"),cursorIndex:this.state.cursorIndex,inputString:this.state.pendingComment,onResultSelect:this.$PostCommentInput14,showResultsCondensed:!0,useSearchTriggers:!0}))},n})(a(d[3]).Component);h.defaultProps={forceTextareaAutosize:r(d[10]).isMobile(),hasRichCommentInput:!1};var C=r(d[30]).connect(function(t,n){var o=t.pendingComments.get(n.id);return{analyticsContext:t.navigation.pageIdentifier||'',commentSaveIsInFlight:(null===o||void 0===o?void 0:o.committing)||!1,loading:t.search.loading,ownerUsername:i(d[9])(r(d[27]).getUserById(t,n.ownerId).username),pendingComment:(null===o||void 0===o?void 0:o.text)||'',repliedToCommentAuthorId:null===o||void 0===o?void 0:o.repliedToCommentAuthorId,repliedToCommentId:null===o||void 0===o?void 0:o.repliedToCommentId,repliedToUsername:null===o||void 0===o?void 0:o.repliedToUsername,results:t.search.results,searchedForQuery:t.search.searchedForQuery,selectedIndex:t.search.selectedIndex,viewportHeight:t.displayProperties.viewportHeight}},function(t,n){return{onCommentChange:function(o,s,u,p){t(r(d[28]).changePendingComment(n.id,o,s,u,p))},onClearReply:function(){t(r(d[28]).clearPendingComment(n.id))},onCommentSubmit:function(o){return t(r(d[28]).commitPendingComment(n.id,n.ownerId,n.analyticsContext,o))},onTypeaheadResultHighlight:function(n,o){t(r(d[29]).selectResult(n,o))}}},function(t,o,s){return n({},t,{},o,{},s,{onCommentChange:function(n){return o.onCommentChange(n,t.repliedToCommentId,t.repliedToCommentAuthorId,t.repliedToUsername)}})},{forwardRef:!0})(h);e.default=C},6160384,[6160385,12910593,12910654,3,12976189,12910898,12911023,12976181,12910678,12976157,12910601,12910651,12910710,12910829,3801132,12714450,12910688,12910853,12910772,12976185,12714453,12714451,12976178,12976180,12976238,12911274,12714426,12910985,6160386,12911307,5]);
__d(function() {},6160385,[]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(o,n,c,s){var u=new(r(d[1]).FunctionalityTracker)('comment');return function(l,p){var C;u.attempt(),l({type:r(d[0]).COMMIT_PENDING_COMMENT_REQUESTED,postId:o}),i(d[2])._("f3cb0e417d8b73758be753a0ddc2afb7")||r(d[3]).logAction_DEPRECATED('comment',{source:c});var E=p(),I=E.pendingComments.get(o,r(d[4]).EMPTY_PENDING_COMMENT),_=I.repliedToCommentAuthorId,T=I.repliedToCommentId,b=I.text,M=E.posts.byId.get(o,{hasRankedComments:!1}).hasRankedComments,f=Boolean(null===(C=r(d[5]).getViewer(E))||void 0===C?void 0:C.isVerified);return u.request(),i(d[6])(r(d[7]).commentOnPost(o,b,T).then(function(t){u.responseSuccess();var C=i(d[8])(r(d[5]).getViewer(p())).id,I=t.id;l({type:r(d[0]).COMMIT_PENDING_COMMENT_SUCCEEDED,postId:o,commentText:b,hasRankedComments:M,commentAuthorId:C,commentAuthorIsVerified:f,commentId:I,postedAt:Math.round(Date.now()/1e3),repliedToCommentId:T}),i(d[2])._("f3cb0e417d8b73758be753a0ddc2afb7")||r(d[3]).logAction_DEPRECATED('commentSuccess',{source:c});var v={commentAuthorId:C,commentId:I,containerModule:c,mediaId:o,mediaAuthorId:n,mediaType:r(d[9]).getMediaTypeById(E,o),parentCommentId:T,parentCommentAuthorId:_};null!=s?r(d[10]).logAdComment(v,s):r(d[11]).logOrganicComment(v),u.completeSuccess()},function(s){var p;u.responseFailure();var C=(null===(p=s.responseObject)||void 0===p?void 0:p.spam)||!1;if(C){var E,I,_,T,b=null===(E=s.responseObject)||void 0===E?void 0:E.feedback_title,M=null===(I=s.responseObject)||void 0===I?void 0:I.feedback_message,f=null===(_=s.responseObject)||void 0===_?void 0:_.feedback_url,v=null===(T=s.responseObject)||void 0===T?void 0:T.feedback_action;l(r(d[12]).showSentryFeedback({title:b,message:M,url:f,action:v}))}l({type:r(d[0]).COMMIT_PENDING_COMMENT_FAILED,postId:o,toast:C?void 0:{text:r(d[13])(2225),actionText:r(d[13])(294),actionHandler:function(){return l(t(o,n,c))}}}),i(d[2])._("f3cb0e417d8b73758be753a0ddc2afb7")||r(d[3]).logAction_DEPRECATED('commentFailure',{source:c}),u.completeFailure()}))}}Object.defineProperty(e,'__esModule',{value:!0}),e.changePendingComment=function(t,o,n,c,s){return{type:r(d[0]).CHANGE_PENDING_COMMENT,postId:t,text:o,repliedToCommentId:n,repliedToCommentAuthorId:c,repliedToUsername:s}},e.clearPendingComment=function(t){return{type:r(d[0]).CLEAR_PENDING_COMMENT,postId:t}},e.commitPendingComment=t},6160386,[12910863,12910998,12910651,12910710,12714124,12910985,12910697,12910797,12976157,3801131,3801133,3801137,12911272,12910654]);